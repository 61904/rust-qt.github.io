<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Setting up - Ritual</title><meta name=description content="Use C++ libraries from Rust"><meta name=generator content="Hugo 0.66.0"><link href=https://rust-qt.github.io/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://rust-qt.github.io/ritual/setting_up/><link rel=stylesheet href=https://rust-qt.github.io/css/theme.min.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script><link rel=stylesheet href=https://rust-qt.github.io/css/chroma.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script><script src=https://rust-qt.github.io/js/bundle.js></script><style>:root{}</style><meta property="og:title" content="Setting up"><meta property="og:description" content="Using docker (recommended) To make sure the parsing results are consistent and reproducible, it&rsquo;s recommended to use a reproducible environment, such as provided by docker.
Ritual provides Dockerfiles containing its dependencies:
 docker.builder.dockerfile is the base image suitable for working on C++'s standard library. It also should be used as a base image when working on other C++ libraries. docker.qt.dockerfile is the image used for generating Qt crates.  You can build the images with these commands:"><meta property="og:type" content="article"><meta property="og:url" content="https://rust-qt.github.io/ritual/setting_up/"><meta property="og:image" content="https://rust-qt.github.io/images/og-image.png"><meta property="og:site_name" content="Ritual"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rust-qt.github.io/images/og-image.png"><meta name=twitter:title content="Setting up"><meta name=twitter:description content="Using docker (recommended) To make sure the parsing results are consistent and reproducible, it&rsquo;s recommended to use a reproducible environment, such as provided by docker.
Ritual provides Dockerfiles containing its dependencies:
 docker.builder.dockerfile is the base image suitable for working on C++'s standard library. It also should be used as a base image when working on other C++ libraries. docker.qt.dockerfile is the image used for generating Qt crates.  You can build the images with these commands:"><meta itemprop=name content="Setting up"><meta itemprop=description content="Using docker (recommended) To make sure the parsing results are consistent and reproducible, it&rsquo;s recommended to use a reproducible environment, such as provided by docker.
Ritual provides Dockerfiles containing its dependencies:
 docker.builder.dockerfile is the base image suitable for working on C++'s standard library. It also should be used as a base image when working on other C++ libraries. docker.qt.dockerfile is the image used for generating Qt crates.  You can build the images with these commands:"><meta itemprop=wordCount content="658"><meta itemprop=image content="https://rust-qt.github.io/images/og-image.png"><meta itemprop=keywords content></head><body><div class=container><header><h1><a href=/>Ritual</a></h1><a href=https://github.com/rust-qt/ritual class=github><i class="fab fa-github"></i></a><p class=description>Use C++ libraries from Rust</p></header><div class=global-menu><nav><ul><li><a href=/ritual/>About Ritual</a></li><li><a href=/qt/>Rust + Qt guide</a></li><li><a href=/blog/>Blog</a></li></ul></nav></div><div class=content-container><main><h1>Setting up</h1><h2 id=using-docker-recommended>Using docker (recommended)</h2><p>To make sure the parsing results are consistent and reproducible, it&rsquo;s recommended to use a reproducible environment, such as provided by <code>docker</code>.</p><p>Ritual provides <code>Dockerfile</code>s containing its dependencies:</p><ul><li><code>docker.builder.dockerfile</code> is the base image suitable for working on C++'s standard library. It also should be used as a base image when working on other C++ libraries.</li><li><code>docker.qt.dockerfile</code> is the image used for generating Qt crates.</li></ul><p>You can build the images with these commands:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=nb>cd</span> ritual
<span class=c1># for any libraries</span>
docker build . -f docker.builder.dockerfile -t ritual_builder

<span class=c1># only for Qt</span>
docker build . -f docker.qt.dockerfile --target qt_downloader -t ritual_qt_downloader
docker build . -f docker.qt.dockerfile -t ritual_qt
</code></pre></div><p>Note that the image contains only the environment. No pre-built ritual artifacts are included. This allows you to edit the source code of your generator and re-run it without the slow process of rebuilding the docker image. You can use <code>cargo</code> to run the generator, just like you would normally do it on the host system.</p><p>When running the container, mount <code>/build</code> to a persistent directory on the host system. This directory will contain all temporary build files, so making it persistent will allow you to recreate the container without having to recompile everything from scratch.</p><p>In addition to the build directory, you should also mount one or more directories containing the source code of your generator and the ritual workspace directory (see below) to make it available in the container. The paths to these directories can be arbitrary.</p><p>This is an example of command that runs a shell in the container:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>docker run <span class=se>\
</span><span class=se></span>    --mount <span class=nv>type</span><span class=o>=</span>bind,source<span class=o>=</span>~/ritual/repo,destination<span class=o>=</span>/repo <span class=se>\
</span><span class=se></span>    --mount <span class=nv>type</span><span class=o>=</span>bind,source<span class=o>=</span>~/ritual/qt_workspace,destination<span class=o>=</span>/qt_workspace <span class=se>\
</span><span class=se></span>    --mount <span class=nv>type</span><span class=o>=</span>bind,source<span class=o>=</span>~/ritual/tmp,destination<span class=o>=</span>/build <span class=se>\
</span><span class=se></span>    --name ritual_qt <span class=se>\
</span><span class=se></span>    --hostname ritual_qt <span class=se>\
</span><span class=se></span>    -it <span class=se>\
</span><span class=se></span>    ritual_qt <span class=se>\
</span><span class=se></span>    bash
</code></pre></div><p>Use <code>cargo</code> to run the generator inside the container, just like in the host system.</p><h2 id=without-docker>Without docker</h2><p>In case you don&rsquo;t want or can&rsquo;t use <code>docker</code>, you can just install all required dependencies on your host system and run your generator natively with <code>cargo</code>, like any Rust project.</p><p><code>ritual</code> requires:</p><ul><li>A C++ build toolchain, compatible with the Rust toolchain in use:<ul><li>On Linux: <code>make</code> and a C++ compiler;</li><li>On Windows: MSVC (Visual Studio or build tools) or MinGW environment;</li><li>On OS X: the command line developer tools (full Xcode installation is not required);</li></ul></li><li>The target C++ library (include and library files);</li><li><a href=https://cmake.org/>cmake</a> ≥ 3.0;</li><li><code>libclang-dev</code> ≥ 3.5;</li><li><code>libsqlite3-dev</code> (only for <code>qt_ritual</code>).</li></ul><p>Note that C++ toolchain, Rust toolchain, and Qt build must be compatible. For example, MSVC and MinGW targets on Windows are not compatible.</p><p>The following environment variables may be required for <code>clang</code> parser to work correctly:</p><ul><li><code>LLVM_CONFIG_PATH</code> (path to <code>llvm-config</code> binary)</li><li><code>CLANG_SYSTEM_INCLUDE_PATH</code> (e.g. <code>$CLANG_DIR/lib/clang/3.8.0/include</code> for <code>clang</code> 3.8.0).</li></ul><p>If a parse error like <code>fatal error: 'stddef.h' file not found</code> is produced when running the generator, check that <code>CLANG_SYSTEM_INCLUDE_PATH</code> variable is set correctly.</p><p>If <code>libsqlite3</code> is not installed system-wide, setting <code>SQLITE3_LIB_DIR</code> environment variable may be required.</p><p>Run <code>cargo test</code> to make sure that dependencies are set up correctly.</p><p><code>RITUAL_TEMP_TEST_DIR</code> variable may be used to specify location of the temporary directory used by tests. If the directory is preserved between test runs, tests will run faster.</p><p><code>RITUAL_WORKSPACE_TARGET_DIR</code> variable overrides the <code>cargo</code>'s target directory when <code>ritual</code> runs <code>cargo</code> on the generated crates.</p><p>Build scripts of generated crates accept <code>RITUAL_LIBRARY_PATH</code>, <code>RITUAL_FRAMEWORK_PATH</code>, <code>RITUAL_INCLUDE_PATH</code> environment variables. They can be used to override paths selected by the build script (if any). If multiple paths need to be specified, separate them in the same way <code>PATH</code> variable is separated on your platform. Additionally, <code>RITUAL_CMAKE_ARGS</code> allows you to specify additional arguments passed to <code>cmake</code> when building C++ glue library.</p><p>C++ build tools and the linker may also read other environment variables, including <code>LIB</code>, <code>PATH</code>, <code>LIBRARY_PATH</code>, <code>LD_LIBRARY_PATH</code>, <code>DYLD_FRAMEWORK_PATH</code>. The generator has API for specifying library paths, passes them to <code>cmake</code> when building the C++ wrapper library, and reports the paths in build script&rsquo;s output, but it may not be enough for the linker to find the library, so you may need to set them manually.</p><div class=edit-meta><a href=https://github.com/rust-qt/website/edit/master/content/ritual/setting_up.md class=edit-page><i class="fas fa-pen-square"></i>Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=https://rust-qt.github.io/ritual/ title="About Ritual"><i class="fas fa-arrow-left" aria-hidden=true></i>Prev - About Ritual</a>
<a class="nav nav-next" href=https://rust-qt.github.io/ritual/running_generator/ title="Running generator">Next - Running generator <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=open-menu><ul><li><a href=https://rust-qt.github.io/>Home</a></li><li class=parent><a href=https://rust-qt.github.io/ritual/>About Ritual</a><ul class=sub-menu><li class=active><a href=https://rust-qt.github.io/ritual/setting_up/>Setting up</a></li><li><a href=https://rust-qt.github.io/ritual/running_generator/>Running generator</a></li></ul></li><li><a href=https://rust-qt.github.io/qt/>Rust + Qt guide</a><ul class=sub-menu><li><a href=https://rust-qt.github.io/qt/setting_up/>Setting up</a></li><li><a href=https://rust-qt.github.io/qt/getting_started/>Getting started</a></li><li><a href=https://rust-qt.github.io/qt/smart_pointers/>Smart pointers</a></li><li><a href=https://rust-qt.github.io/qt/unsafety/>Unsafety</a></li><li><a href=https://rust-qt.github.io/qt/deployment/>Deployment</a></li></ul></li><li><a href=https://rust-qt.github.io/processing_cpp_library/>Processing a C++ library</a><ul class=sub-menu><li><a href=https://rust-qt.github.io/processing_cpp_library/setting_up/>Setting up</a></li><li><a href=https://rust-qt.github.io/processing_cpp_library/running_generator/>Running generator</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i><i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>